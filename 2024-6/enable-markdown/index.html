
<!DOCTYPE html>
<html lang="Ja">
  <head>
    <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="The Infinity's awesome blog article" />
    <meta name="description" content="The Infinity's awesome blog article" />
    <title>markdownでブログを書けるようにした</title>
    <link rel="stylesheet" href="../../Infinity-style/style.css" />
    <script defer src="../../Infinity-style/script.js"></script>
    <script defer src="/The-Infinitys-Infinity/script.js"></script>
    <link rel="stylesheet" href="/The-Infinitys-Infinity/style.css">
    <script defer src="/The-Infinitys-Infinity/script.js"></script>
    <link rel="stylesheet" href="/The-Infinitys-Infinity/style.css" />
    <script
    defer
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2045274771035552"
    crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="article-body">
      <div id="article-content">
        <h2 id="html">余りにも面倒だったhtml</h2>
        <p>どうもどうも! The Infinitysです!<br />
        最近blogを書いていて、思ったことがあるんですよね&hellip;</p>
        <p>「いちいちhtmlで書くのは面倒臭いな&hellip;(´・ω・)」</p>
        <p>と。それでも今日までずっとhtmlで書いてきて慣れていたので、まあいっかって思ったんです。ですが私の友人の人子がきっかけでその考えは変わりました。</p>
        <p>「markdownでblogを書きたい」</p>
        <p>その時私の何かがフツッと切れ、次の瞬間にはキーボードをばちばち叩く私の姿が٩( ᐛ )وやっぱりhtmlで書くのは面倒くさい！</p>
        <p>そう言うわけで、私はhtmlで書くのをやめたいと思いました。これからはブログは全てmarkdown経由で書きます。</p>
        <h2 id="_1">どうやってやったのか</h2>
        <p>私も一プログラマですので、自分のやりたい事くらいは自分でできなければメンタルが持ちません。そう言うわけでググりながら調べまわりました。<br />
        markdownで書くうえで一切htmlを経由せずに書けるように、プログラムで自動化しました。まずは、pythonでスクリプトを書きます。</p>
        <h4 id="markdown-converterpy">markdown-converter.pyのソースコード</h4>
        <div class="codehilite" style="background: #ffffff"><pre style="line-height: 125%;"><span></span><code><span style="color: #0000ff">import</span> datetime
        <span style="color: #0000ff">import</span> os
        <span style="color: #0000ff">import</span> markdown
        <span style="color: #0000ff">from</span> sys <span style="color: #0000ff">import</span> exit
        article_temp_head=<span style="color: #a31515">&#39;&#39;&#39;</span>
        <span style="color: #a31515">&lt;!DOCTYPE html&gt;</span>
        <span style="color: #a31515">&lt;html lang=&quot;Ja&quot;&gt;</span>
        <span style="color: #a31515">  &lt;head&gt;</span>
        <span style="color: #a31515">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span>
        <span style="color: #a31515">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;&lt;meta name=&quot;description&quot; content=&quot;The Infinity&#39;s awesome blog article&quot; /&gt;</span>
        <span style="color: #a31515">    &lt;title&gt;HERE TO THE TITLE&lt;/title&gt;</span>
        <span style="color: #a31515">    &lt;link rel=&quot;stylesheet&quot; href=&quot;../../Infinity-style/style.css&quot; /&gt;</span>
        <span style="color: #a31515">    &lt;script defer src=&quot;../../Infinity-style/script.js&quot;&gt;&lt;/script&gt;</span>
        <span style="color: #a31515">  &lt;script defer src=&quot;/The-Infinitys-Infinity/script.js&quot;&gt;&lt;/script&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/The-Infinitys-Infinity/style.css&quot; /&gt;</span>
        <span style="color: #a31515">    &lt;script</span>
        <span style="color: #a31515">    defer</span>
        <span style="color: #a31515">    src=&quot;https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2045274771035552&quot;</span>
        <span style="color: #a31515">    crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;&lt;/head&gt;</span>
        <span style="color: #a31515">  &lt;body&gt;&lt;div id=&quot;article-body&quot;&gt;&lt;div id=&quot;article-content&quot;&gt;</span>
        <span style="color: #a31515">&#39;&#39;&#39;</span>
        article_temp_foot=<span style="color: #a31515">&#39;&#39;&#39;</span>
        <span style="color: #a31515">  &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;</span>
        <span style="color: #a31515">&lt;/html&gt;</span>
        <span style="color: #a31515">&#39;&#39;&#39;</span>
        <span style="color: #0000ff">def</span> listfolders(dir_path):
          result = [
              f <span style="color: #0000ff">for</span> f <span style="color: #0000ff">in</span> os.listdir(dir_path) <span style="color: #0000ff">if</span> os.path.isdir(os.path.join(dir_path, f))
          ]
          <span style="color: #0000ff">return</span> result
        <span style="color: #0000ff">def</span> listfiles(dir_path):
          result = [
              f <span style="color: #0000ff">for</span> f <span style="color: #0000ff">in</span> os.listdir(dir_path) <span style="color: #0000ff">if</span> os.path.isfile(os.path.join(dir_path, f))
          ]
          <span style="color: #0000ff">return</span> result
        now=datetime.datetime.now()
        now=str(now.year)+<span style="color: #a31515">&quot;-&quot;</span>+str(now.month)
        root_dir=<span style="color: #a31515">&quot;./&quot;</span>+now
        <span style="color: #0000ff">def</span> renew():
          os.system(<span style="color: #a31515">&quot;git config user.name github-actions&quot;</span>)
          os.system(<span style="color: #a31515">&quot;git config user.email github-actions@github.com&quot;</span>)
          os.system(<span style="color: #a31515">&quot;git add .&quot;</span>)
          os.system(<span style="color: #a31515">&quot;git commit -m \&quot;convert markdown\&quot;&quot;</span>)
          os.system(<span style="color: #a31515">&quot;git push&quot;</span>)
        <span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span> os.path.isdir(root_dir):
          print(<span style="color: #a31515">&quot;No datas&quot;</span>)
          exit()
        <span style="color: #0000ff">for</span> article_dir <span style="color: #0000ff">in</span> listfolders(root_dir):
          path = root_dir+<span style="color: #a31515">&quot;/&quot;</span>+article_dir
          file_names = listfiles(path)
          index_path = <span style="color: #0000ff">None</span>
          article_path=<span style="color: #0000ff">None</span>
          <span style="color: #0000ff">for</span> file_name <span style="color: #0000ff">in</span> file_names:
            <span style="color: #0000ff">if</span> file_name.startswith(<span style="color: #a31515">&quot;index&quot;</span>):
              index_path=file_name
            <span style="color: #0000ff">elif</span> file_name==(<span style="color: #a31515">&quot;article.md&quot;</span>):
              article_path=file_name
          <span style="color: #0000ff">if</span> article_path!=<span style="color: #0000ff">None</span>:
            markdown_text = <span style="color: #a31515">&quot;&quot;</span>
            markdown_title = <span style="color: #a31515">&quot;&quot;</span>
            <span style="color: #0000ff">with</span> open(root_dir+<span style="color: #a31515">&quot;/&quot;</span>+article_dir+<span style="color: #a31515">&quot;/&quot;</span>+article_path,mode=<span style="color: #a31515">&quot;r&quot;</span>) <span style="color: #0000ff">as</span> f:
              markdown_text = f.read()
              f.close()
            markdown_result = <span style="color: #a31515">&quot;&quot;</span>
            <span style="color: #0000ff">for</span> markdown_line <span style="color: #0000ff">in</span> markdown_text.split(<span style="color: #a31515">&quot;\n&quot;</span>):
              <span style="color: #0000ff">if</span> markdown_line.startswith(<span style="color: #a31515">&quot;#title: &quot;</span>):
                markdown_title=markdown_line[8:]
              <span style="color: #0000ff">else</span>:
                markdown_result+=markdown_line+<span style="color: #a31515">&quot;\n&quot;</span>
            html_text=markdown.markdown(markdown_result)
            html_result=<span style="color: #a31515">&quot;&quot;</span>
            <span style="color: #0000ff">for</span> html_line <span style="color: #0000ff">in</span> html_text.split(<span style="color: #a31515">&quot;\n&quot;</span>):
              html_result+=<span style="color: #a31515">&quot; &quot;</span>*4+html_line+<span style="color: #a31515">&quot;\n&quot;</span>
            <span style="color: #0000ff">if</span> index_path!=<span style="color: #0000ff">None</span>:
              os.system(<span style="color: #a31515">&quot;rm &quot;</span>+root_dir+<span style="color: #a31515">&quot;/&quot;</span>+article_dir+<span style="color: #a31515">&quot;/&quot;</span>+index_path)
            <span style="color: #0000ff">with</span> open(root_dir+<span style="color: #a31515">&quot;/&quot;</span>+article_dir+<span style="color: #a31515">&quot;/index.html&quot;</span>,mode=<span style="color: #a31515">&quot;w&quot;</span>) <span style="color: #0000ff">as</span> f:
              f.write(article_temp_head.replace(<span style="color: #a31515">&quot;HERE TO THE TITLE&quot;</span>,markdown_title)+html_result+article_temp_foot)
              f.close()
        renew()
        </code></pre></div>
        
        <p>これだけのプログラムを自力で書きました&hellip;(´・ω・)ある程度(リポジトリの更新とファイル・フォルダ構造の解析)はapiのプログラムから流用が効いたのですが&hellip;こんなことをするのは恐らく私が初めてみたいで、参考になるような情報は一切合切手に入りませんでした。<br />
        そして次に、github actionsのyamlファイルを書きました。</p>
        <h4 id="yaml">yamlファイルの方</h4>
        <p><code>github actions
        name: The-Infinitys_Blog-markdown
        run-name: converting markdown
        on: push
        jobs:
          markdown-convert:
            permissions:
              repository-projects: write
              contents: write
            runs-on: ubuntu-latest
            steps:
              - uses: actions/checkout@v4
              - run: git pull
              - run: pip install markdown
              - run: python ./programs/markdown-converter.py</code><br />
        こっちのyamlファイルはがっつりapiから流用できたので苦でもありませんでした。</p>
        <h2 id="_2">やってみた感想</h2>
        <p>激ムズすぎて二度とやりたくないです(´・ω・)<br />
        <date>2024/06/13</date></p>
      </div>
    </div>
  </body>
</html>
