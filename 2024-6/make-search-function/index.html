
<!DOCTYPE html>
<html lang="Ja">
  <head>
    <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="The Infinity's awesome blog article" />
    <meta name="description" content="The Infinity's awesome blog article" />
    <title>検索機能を搭載する</title>
    <link rel="stylesheet" href="../../Infinity-style/style.css" />
    <script defer src="../../Infinity-style/script.js"></script>
    <script defer src="/The-Infinitys-Infinity/script.js"></script>
    <link rel="stylesheet" href="/The-Infinitys-Infinity/style.css">
    <link rel="stylesheet" href="../../Infinity-style/codehighlight.css">
    <script defer src="/The-Infinitys-Infinity/script.js"></script>
    <link rel="stylesheet" href="/The-Infinitys-Infinity/style.css" />
    <script
    defer
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2045274771035552"
    crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="article-body">
      <div id="article-content">
        <h1 id="_1">検索機能をブログに搭載しました</h1>
        <p>The Infinity&rsquo;sです。つい最近<br />
        <a href="../update_and_add_blog_list/">次のブログ記事を表示する機能を追加</a><br />
        したばかりですが、<br />
        機能的には足りませんでした、と言うのもですね&hellip;<br />
        私のブログには<strong>検索機能</strong>が存在して居なかったんですよ&hellip;<br />
        それでこのままではまずいと思いまして、ブログに検索機能を足しました。</p>
        <h2 id="_2">面倒だった作業</h2>
        <p>やり方としては、inputエレメントを改めて作り、そこに検索クエリを入れる方式にします。</p>
        <h3 id="html">html</h3>
        <div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>&lt;<span style="color: #008000; font-weight: bold">div</span> <span style="color: #687822">id</span><span style="color: #666666">=</span><span style="color: #BA2121">&quot;list-head&quot;</span>&gt;
          &lt;<span style="color: #008000; font-weight: bold">h1</span>&gt;Blog List&lt;/<span style="color: #008000; font-weight: bold">h1</span>&gt;
          &lt;<span style="color: #008000; font-weight: bold">div</span>&gt;
            &lt;<span style="color: #008000; font-weight: bold">img</span>
              <span style="color: #687822">onclick</span><span style="color: #666666">=</span><span style="color: #BA2121">&quot;search_articles()&quot;</span>
              <span style="color: #687822">src</span><span style="color: #666666">=</span><span style="color: #BA2121">&quot;../image/Infinity-search.svg&quot;</span>
              <span style="color: #687822">alt</span><span style="color: #666666">=</span><span style="color: #BA2121">&quot;&quot;</span> /&gt;
            &lt;<span style="color: #008000; font-weight: bold">input</span> <span style="color: #687822">id</span><span style="color: #666666">=</span><span style="color: #BA2121">&quot;search&quot;</span> <span style="color: #687822">type</span><span style="color: #666666">=</span><span style="color: #BA2121">&quot;text&quot;</span> <span style="color: #687822">onchange</span><span style="color: #666666">=</span><span style="color: #BA2121">&quot;search_articles()&quot;</span> /&gt;
          &lt;/<span style="color: #008000; font-weight: bold">div</span>&gt;
        &lt;/<span style="color: #008000; font-weight: bold">div</span>&gt;
        </code></pre></div>
        
        <p>こんな感じです。<br />
        次に、CSSの適用&hellip;</p>
        <h3 id="css">CSS</h3>
        <div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>#<span style="color: #0000FF; font-weight: bold">list-head</span><span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">width</span>:<span style="color: #bbbbbb"> </span><span style="color: #666666">100</span><span style="color: #B00040">%</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">height</span>:<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">auto</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">display</span>:<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">flex</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">@media</span><span style="color: #bbbbbb"> </span><span style="border: 1px solid #FF0000">(</span>max-aspect-ratio:<span style="color: #666666">1/1</span>)<span style="color: #bbbbbb"> </span><span style="border: 1px solid #FF0000">{</span><span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">    </span><span style="color: #008000; font-weight: bold">display</span><span style="color: #666666">:</span><span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">block</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span>}<span style="color: #bbbbbb"></span>
        <span style="border: 1px solid #FF0000">}</span><span style="color: #bbbbbb"></span>
        
        #<span style="color: #0000FF; font-weight: bold">list-head</span><span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">h1</span><span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">margin-right</span>:<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">auto</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">position</span>:<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">relative</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">font-size</span>:<span style="color: #bbbbbb"> </span><span style="color: #666666">4</span><span style="color: #B00040">vh</span>;<span style="color: #bbbbbb"></span>
        }<span style="color: #bbbbbb"></span>
        
        #<span style="color: #0000FF; font-weight: bold">list-head</span><span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">div</span><span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">width</span>:<span style="color: #bbbbbb"> </span><span style="color: #666666">40</span><span style="color: #B00040">vh</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">height</span>:<span style="color: #bbbbbb"> </span><span style="color: #666666">4</span><span style="color: #B00040">vh</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">background-color</span>:<span style="color: #bbbbbb"> </span><span style="color: #0000FF">var</span>(<span style="color: #19177C">--background</span>);<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">display</span>:<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">flex</span><span style="color: #bbbbbb"> </span><span style="color: #666666">1</span><span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">auto</span>;<span style="color: #bbbbbb"></span>
        }<span style="color: #bbbbbb"></span>
        
        #<span style="color: #0000FF; font-weight: bold">list-head</span><span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">div</span><span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">img</span><span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">width</span>:<span style="color: #bbbbbb"> </span><span style="color: #666666">10</span><span style="color: #B00040">%</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">height</span>:<span style="color: #bbbbbb"> </span><span style="color: #666666">100</span><span style="color: #B00040">%</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">margin-right</span>:<span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">auto</span>;<span style="color: #bbbbbb"></span>
        }<span style="color: #bbbbbb"></span>
        
        #<span style="color: #0000FF; font-weight: bold">list-head</span><span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">div</span><span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">input</span><span style="color: #bbbbbb"> </span>{<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">width</span>:<span style="color: #bbbbbb"> </span><span style="color: #666666">85</span><span style="color: #B00040">%</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">height</span>:<span style="color: #bbbbbb"> </span><span style="color: #666666">100</span><span style="color: #B00040">%</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">font-size</span>:<span style="color: #bbbbbb"> </span><span style="color: #666666">4</span><span style="color: #B00040">vh</span>;<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">background-color</span>:<span style="color: #bbbbbb"> </span><span style="color: #0000FF">var</span>(<span style="color: #19177C">--background</span>);<span style="color: #bbbbbb"></span>
        <span style="color: #bbbbbb">  </span><span style="color: #008000; font-weight: bold">color</span>:<span style="color: #bbbbbb"> </span><span style="color: #0000FF">var</span>(<span style="color: #19177C">--text</span>);<span style="color: #bbbbbb"></span>
        }<span style="color: #bbbbbb"></span>
        </code></pre></div>
        
        <p>そしてjavascript&hellip;</p>
        <h3 id="javascript">JavaScript</h3>
        <div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #3D7B7B; font-style: italic">//検索機能</span>
        <span style="color: #008000; font-weight: bold">const</span> article_search_input <span style="color: #666666">=</span> <span style="color: #008000">document</span>.querySelector(<span style="color: #BA2121">&quot;#list-head div input&quot;</span>);
        <span style="color: #008000; font-weight: bold">const</span> search_articles <span style="color: #666666">=</span> () =&gt; {
          <span style="color: #008000; font-weight: bold">const</span> search_query <span style="color: #666666">=</span> article_search_input.value.replace(<span style="color: #BA2121">&quot;　&quot;</span>, <span style="color: #BA2121">&quot; &quot;</span>).toLowerCase();
          <span style="color: #008000; font-weight: bold">const</span> blog_buttons <span style="color: #666666">=</span> <span style="color: #008000">document</span>.querySelector(<span style="color: #BA2121">&quot;#blog-button-section&quot;</span>).children;
          <span style="color: #008000; font-weight: bold">if</span> (search_query <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;&quot;</span>) {
            <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #008000; font-weight: bold">let</span> i <span style="color: #666666">=</span> <span style="color: #666666">0</span>; i <span style="color: #666666">&lt;</span> blog_buttons.length; i<span style="color: #666666">++</span>) {
              blog_buttons[i].style.display <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&quot;</span>;
            }
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">null</span>;
          }
          <span style="color: #008000; font-weight: bold">const</span> search_querys <span style="color: #666666">=</span> search_query.split(<span style="color: #BA2121">&quot; &quot;</span>);
          <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #008000; font-weight: bold">let</span> i <span style="color: #666666">=</span> <span style="color: #666666">0</span>; i <span style="color: #666666">&lt;</span> blog_buttons.length; i<span style="color: #666666">++</span>) {
            <span style="color: #008000; font-weight: bold">const</span> blog_button <span style="color: #666666">=</span> blog_buttons[i];
            <span style="color: #008000; font-weight: bold">const</span> button_inner <span style="color: #666666">=</span> blog_button.innerHTML;
            <span style="color: #008000; font-weight: bold">const</span> title <span style="color: #666666">=</span> button_inner.substring(button_inner.indexOf(<span style="color: #BA2121">&quot;&lt;div&gt;&quot;</span>) <span style="color: #666666">+</span> <span style="color: #666666">5</span>, button_inner.indexOf(<span style="color: #BA2121">&quot;&lt;/div&gt;&quot;</span>)).toLowerCase();
            blog_button.style.display <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&quot;</span>;
            <span style="color: #008000; font-weight: bold">for</span> (<span style="color: #008000; font-weight: bold">let</span> j <span style="color: #666666">=</span> <span style="color: #666666">0</span>; j <span style="color: #666666">&lt;</span> search_querys.length; <span style="color: #666666">++</span>j) {
              <span style="color: #008000; font-weight: bold">if</span> (<span style="color: #666666">-1</span> <span style="color: #666666">==</span> title.indexOf(search_querys[j])) {
                blog_button.style.display <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;none&quot;</span>;
              }
            }
          }
          <span style="color: #008000; font-weight: bold">return</span> search_query;
        }
        </code></pre></div>
        
        <h2 id="_3">仕組みの解説</h2>
        <p>全体的な仕組みとしては、</p>
        <ol>
        <li>searchクエリが入力される</li>
        <li>検索ボタンかenterが押される</li>
        <li>全てのボタンをチェック開始する</li>
        <li>ブログボタンを初期化(一旦displayの値をnullにする)</li>
        <li>検索クエリを含まないブログのボタンのdisplayをnoneに設定する</li>
        <li>(4-5の作業を)繰り返す</li>
        </ol>
        <p>と言うふうになっています。</p>
        <h2 id="_4">感想</h2>
        <p>かなり難しかったです。検索機能の実装自体が難しいのと、<br />
        アイコンを書いていくのが大変でした。検索アイコンはここにあります。<br />
        <img alt="search_icon" src="/image/Infinity-search.svg" /></p>
        <p><date>2024/06/19</date></p>
      </div>
    </div>
  </body>
</html>
